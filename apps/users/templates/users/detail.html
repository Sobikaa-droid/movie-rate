{% extends 'base.html' %}
{% block title %}{{ user.username }}{% endblock %}
{% block content %}
{% load widget_tweaks %}
{% load static %}
<div class="container mt-5 mb-5" data-bs-theme="dark">
  <div class="user_detail">
    <div class="d-flex flex-wrap justify-content-center">
      <div class='user_detail_info ms-5 w-75 mt-5 mb-5 me-5'>
        <div class='user-header d-flex'>
            <div class='user-part d-flex me-auto'>
              <div class='me-4'>
                {% if user.image %}
                <img class="user_image" width="100" height="100" src="{{ user.image.url }}" alt="user_img">
                {% else %}
                <img class="user_image" width="100" height="100" src="{% static 'default.jpg' %}" alt="user_img">
                {% endif %}
              </div>
              <div class='mb-auto mt-auto'>
                <h3 class='fw-bold'>{{ user.username }}</h3>
                <h6 class="text-secondary">{{ user.first_name }} {{ user.second_name }}</h6>
              </div>
            </div>
            <div class='user-info-part mb-auto mt-auto d-flex'>
              <div class="text-center me-4">
                <h3 class='fw-bold' style='margin-bottom: 0;'>8</h3>
                <small class='text-secondary'>Movies</small>
              </div>
              <div class="text-center me-4">
                <h3 class='fw-bold' style='margin-bottom: 0;'>2</h3>
                <small class='text-secondary'>Favorites</small>
              </div>
              <div class="text-center me-4">
                <h3 class='fw-bold' style='margin-bottom: 0;'>3</h3>
                <small class='text-secondary'>Ratings</small>
              </div>
              <div class="text-center">
                <h3 class='fw-bold' style='margin-bottom: 0;'>3</h3>
                <small class='text-secondary'>Reviews</small>
              </div>
            </div>
        </div>
        <ul class="nav nav_filter_by nav-underline justify-content-center border border-secondary border-opacity-25 mt-4 mb-4 rounded">
          <li class="nav-item">
              <a class="nav-link {% if request.GET.filter_val == None %} link-dark {% endif %} me-3" aria-current="page" href="{% url 'movies:list' %}">
                  <h5>Profile</h5>
              </a>
          </li>
          <li class="nav-item">
              <a class="nav-link {% if request.GET.filter_val == 'movie' %} link-dark {% endif %} me-3" href="{% url 'movies:list' %}?filter_val=movie">
                  <h5>Films</h5>
              </a>
          </li>
          <li class="nav-item">
            <a class="nav-link {% if request.GET.filter_val == 'movie' %} link-dark {% endif %} me-3" href="{% url 'movies:list' %}?filter_val=movie">
                <h5>Favorites</h5>
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link {% if request.GET.filter_val == 'movie' %} link-dark {% endif %} me-3" href="{% url 'movies:list' %}?filter_val=movie">
                <h5>Watchlist</h5>
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link {% if request.GET.filter_val == 'movie' %} link-dark {% endif %} me-3" href="{% url 'movies:list' %}?filter_val=movie">
                <h5>Reviews</h5>
            </a>
          </li>
        </ul>
        <div class='user-favorites mt-5'>
          <div class='d-flex'>
            <h4 class='fw-bold me-auto'>Favorites</h4>
            {% if user.fav_user_set.all.count > 5 %}
            <a class='mb-auto mt-auto link link-secondary text-decoration-none' href=''>See all</a>
            {% endif %}
          </div>
          <div class="row row-cols-xxl-5 row-cols-xl-5 row-cols-lg-3 row-cols-md-2 row-cols-sm-2 g-4">
            {% for fav in user.fav_user_set.all|slice:":5" %}
            <div class="col">
                <div class="card bg-transparent">
                    <a href="{{ fav.movie.get_absolute_url }}" class="card_image_link text-decoration-none">
                    <img src="{{ fav.movie.poster }}" class="card-img-top card_gradient page_detail_other_image" style='width: 170px; height: 275px;' />
                    </a>
                </div>
            </div>
            {% endfor %}
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}